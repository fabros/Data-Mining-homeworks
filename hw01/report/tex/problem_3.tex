% !TeX spellcheck = en_GB

\section{Problem 3}

A group of n man and m women go to a Chinese restaurant and sit in a round table,
such that each person has to other person next to him/her.
\begin{itemize}
	\item[1.] Describe a sample space that describes the random process.
	\item[2.] Find the expected number of men who will be sitted next to at least one woman.
\end{itemize} 


\subsection{Probability space definition}

Let $S = \{1, \ldots, n+m\}$ be the set of people sitted at the table. Let $\Omega$ be the probability space of this process. Therefore,
\begin{align*}
	\Omega &= Sym(S)\\
	&= \text{symmetric group of S}\\
	&= \text{collection of all permutations of the elements in S}
\end{align*}
i.e. it consists in all possible permutations of the people sitting around the table (assuming, without loss of generality, an order among the seats).\\
By definition of symmetric group\cite{sym_group}, we have that
\begin{align*}
	|\Omega| = (n+m)!
\end{align*}
In addition, we have that $\Omega$ is an equiprobable space, since every permutation of the people has the same probability to be chosen (at random). Therefore,
\begin{align*}
	\Pr(\omega) = \dfrac{1}{|\Omega|} = \dfrac{1}{(n+m)!} \qquad \forall \ \omega\in\Omega
\end{align*}


\subsection{Expectation}

Let $X$ be a discrete random variable representing the total number of men sitted next to at least a woman, defined as
\begin{align*}
	X: \Omega \rightarrow \{ x \in \mathbb{N} \ | \ 0 \leq x \leq n \}
\end{align*}
Let $X_i$ be a Bernoulli random variable representing whether the $i\text{-} th$ man is sitted next to at least a woman or not. Hence,
\begin{align*}
	X_i = 
	\left\{ \begin{aligned}
		1 &\quad\text{if man is sitted next to at least a woman}\\
		0 &\quad\text{otherwise}
	\end{aligned}\right.
\end{align*}
Therefore, we have that
\begin{align}
	X = \sum_{i = 1}^{n}X_i \quad\Rightarrow\quad E\left[ X \right] = \sum_{i = 1}^{n} E\left[ X_i \right] \label{lin_expect}
\end{align}
Note that we can write (\ref{lin_expect}) because of the linearity of expectation.\\
Therefore, we need to compute $E\left[ X_i \right]$ in order to get the desired expected value.
\begin{align}
	E\left[ X_i \right] &= \sum_{k \in \mathrm{range}(X_i)} k \cdot \Pr(X_i = k)\nonumber\\
	&= \Pr(X_i = 1)\nonumber\\
	&= 1 - \Pr(X_i = 0)\nonumber\\
	&= 1 - \dfrac{(n+m) \cdot \binom{n-1}{2} \cdot 2 \cdot (n+m-3)!}{(n+m)!} \label{pr_xi0}\\
	&= 1 - \dfrac{(n-1) \cdot (n-2)}{(n+m-1) \cdot (n+m-2)} \label{expect_xi}
\end{align}
Let us focus on result (\ref{pr_xi0}). We trivially computed $\Pr(X_i = 0)$, i.e. the probability that a man is not seated next to a woman, by enumerating all cases in which the $i \text{-} th$ man is sitted next to other two men. Indeed, there are:
\begin{itemize}
	\item $n+m$ possible seats for the $i \text{-} th$ man.
	\item $\binom{n-1}{2}$ ways to choose other two men.
	\item 2 ways to arrange other two men ("around" the $i \text{-} th$ man).
	\item $(n+m-3)!$ permutations of the remaining people.
\end{itemize}
Hence, substituting (\ref{expect_xi}) into (\ref{lin_expect}), we have that
\begin{align*}
	E\left[ X \right] = \left( 1 - \dfrac{(n-1) \cdot (n-2)}{(n+m-1) \cdot (n+m-2)} \right) \cdot n
\end{align*}
